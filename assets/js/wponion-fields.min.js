"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};!function(n,i,f,h,e,o){var t=wp.hooks;e.fn.inputmask=function(){if(0<this.elem.length){var n=this.arg("inputmask");n&&(this.elem.inputmask(n),h.__plugin_debug_info(this.elem,"inputmask",n))}return this},e.fn.maxlength=function(){if(0<this.elem.length){var n=this.arg("max_length");n&&(n.appendToParent=!0,void 0!==n.threshold&&(n.threshold=parseInt(n.threshold)),void 0===n.warningClass&&(n.warningClass="badge badge-success"),void 0===n.limitReachedClass&&(n.limitReachedClass="badge badge-danger"),this.elem.maxlength(n),h.__plugin_debug_info(this.elem,"max_length",n))}return this},e.fn.field_debug=function(){0<this.elem.find(".wponion-field-debug").length&&this.elem.find(".wponion-field-debug a.wponion-field-debug-handle").on("click",function(){var i=h._get_debug_info(f(this),{}),n=h.field_js_id(f(this))+"debugINFO",e="<p class='wponion-field-debug-notice'>"+h.settings("debug_notice")+"</p>",o=f("<div id='"+n+"' class='wponion-field-debug-popup' ><div id='"+n+"' ></div> "+e+"</div>");swal({html:o,showConfirmButton:!0,confirmButtonText:h.txt("get_json_output","Get JSON Output"),showCloseButton:!1,width:"800px",onOpen:function(){f("#swal2-content > div > #"+n).jsonView(i).overlayScrollbars({className:"os-theme-dark",resize:"vertical"})}}).then(function(n){n.value&&swal({width:"600px",html:'<textarea style="min-width:550px; min-height:300px">'+JSON.stringify(i)+"</textarea>"})})});return this},e.fn.icon_picker=function(){var n=this,i=n.elem,e=n.args(),o=i.find(".wponion-icon-picker-input"),t=i.find("button.wponion-remove-icon"),l=i.find("button.wponion-add-icon"),a=i.find("span.wponion-icon-preview"),r={elems:null,popup:null,popupel:null,init_tooltip:function(){if("false"!==e.popup_tooltip){var n="object"===_typeof(e.popup_tooltip)?e.popup_tooltip:{};0<r.elems.length&&r.elems.each(function(){tippy(f(this)[0],n)})}},init:function(n,i){r.popupel=n,r.popup=i,r.elems=r.popupel.find("span.wponion-icon-preview");var e=r.popupel.find(".wponion-icon-picker-container-scroll").css("height");r.popupel.find(".wponion-icon-picker-container-scroll").css("height",e),r.select(),r.input(),r.elems.on("click",function(){var n=f(this).attr("data-icon");o.val(n).trigger("change"),swal.closeModal()}),r.init_tooltip()},input:function(){r.popupel.find("div.wponion-icon-picker-model-header input[type=text]").on("keyup",function(){var n=f(this).val();r.elems.each(function(){f(this).attr("data-icon").search(new RegExp(n,"i"))<0?f(this).parent().hide():f(this).parent().show()})})},select:function(){r.popupel.find("div.wponion-icon-picker-model-header select").on("change",function(){swal.enableLoading();var n=f(this).val();h.ajax("icon_picker",{data:{"wponion-icon-lib":n}},function(n){n.success?(swal.resetValidationError(),f(r.popupel).find("#swal2-content").html(n.data).show(),f(r.popupel).find("#swal2-content .wponion-icon-picker-container-scroll").overlayScrollbars({className:"os-theme-dark",resize:"vertical"}),r.init(r.popupel,r.popup)):(f(r.popupel).find(".wponion-icon-picker-container-scroll").remove(),r.popup.showValidationError(n.data))},function(){r.popup.showValidationError(h.txt("unknown_ajax_error"))},function(){r.popup.disableLoading()})})}};""===o.val()&&(t.hide(),a.hide()),o.on("keyup blur change keypress",function(){var n=f(this).val();""!==n?(a.html('<i class="'+n+'"></i>').show(),t.show()):(a.hide(),t.hide())}),l.on("click",function(){var o=swal({title:i.find(".wponion-field-title h4").html(),animation:!1,allowOutsideClick:!1,showConfirmButton:!1,showCloseButton:!0,width:"700px",customClass:"wponion-icon-picker-model",onBeforeOpen:function(e){swal.enableLoading(),n.ajax("icon_picker",{onSuccess:function(n){if(n.success){swal.resetValidationError();var i=f(e);i.find("#swal2-content").html(n.data).show(),i.find("#swal2-content .wponion-icon-picker-container-scroll").overlayScrollbars({className:"os-theme-dark",resize:"vertical"}),r.init(i,o)}else h.tost({type:"error",title:n.data}),o.showValidationError(n.data)},onError:function(){o.showValidationError(h.txt("unknown_ajax_error"))},onAlways:function(){o.disableLoading()}})}})}),t.on("click",function(){o.val(""),a.hide(),t.hide()})},e.fn.select2=function(){var n=this.arg("select2",{});this.elem.select2(n)},e.fn.chosen=function(){var n=this.arg("chosen");this.elem.chosen(n)},e.fn.selectize=function(){var n=this.arg("selectize");void 0!==n.theme&&this.elem.parent().addClass(n.theme),this.elem.selectize(n)},e.fn.clone_element=function(){var l=this,a=l.elem.find("div.wponion-clone-wrap"),r=a.find(".wponion-clone-add"),n=a.find(".wponion-clone-remove"),i=l.arg("clone"),s=void 0!==i.limit&&i.limit,p=void 0===i.toast_error||i.toast_error,c=i.error_msg,d=function(){if(!f(this).hasClass("removing")){f(this).addClass("removing").parent().parent().remove();var n=parseInt(a.attr("data-wponion-clone-count"))-1;a.attr("data-wponion-clone-count",n)}};r.on("click",function(){var n=l.arg("clone_template"),i=parseInt(a.attr("data-wponion-clone-count"));if(!1===s||s!==i){var e=i+1;if(n){n=n.replace(/{cloneid}/g,e),a.attr("data-wponion-clone-count",e),f(this).parent().parent().find("div.wponion-clone-actions").before(f(n));var o=f(this).parent().parent().before();o.find(".wponion-clone-remove").on("click",d),wponion_field(o).reload()}}else if(!0===p)h.tost({type:"error",title:c});else{var t=f('<div class="alert alert-warning" role="alert">'+c+"</div>");t.hide(),r.parent().prepend(t),(t=r.parent().find("div.alert")).fadeIn(function(){setTimeout(function(){t.fadeOut("slow",function(){t.remove()})},1e3)})}}),n.on("click",d)},e.fn.field_tooltip=function(){var n=this.elem.attr("data-field-jsid"),o={};if(console.log(this.args()),this.arg(n)){var i=this.arg(n+"tooltip");!1!==i.image&&(0===f("#wponiontooltipimagetippy").length&&f("body").append(f('<div id="wponiontooltipimagetippy" style="display: none;">Loading.</div>')),i.html="#wponiontooltipimagetippy",i.onShow=function(){var e=this.querySelector(".tippy-content");o.loading||(o.loading=!0,fetch(i.image).then(function(n){return n.blob()}).then(function(n){var i=URL.createObjectURL(n);e.innerHTML='<img width="200" height="200" src="'+i+'">',o.loading=!1}).catch(function(n){e.innerHTML="Loading failed",o.loading=!1}))},i.onHidden=function(){this.querySelector(".tippy-content").innerHTML=""},i.popperOptions={modifiers:{preventOverflow:{enabled:!1},hide:{enabled:!1}}}),o=tippy(this.elem[0],i)}},e.fn.reload=function(){t.addAction("wponion_before_fields_reload"),this.init_field("input[data-wponion-inputmask]","inputmask"),this.init_field("[data-wponion-maxlength]","maxlength"),this.init_field(".wponion-element-icon_picker","icon_picker"),this.init_field(".select2","select2"),this.init_field(".chosen","chosen"),this.init_field(".selectize","selectize"),this.init_field(".wponion-element-clone","clone_element"),this.init_field(".wponion-field-tooltip","field_tooltip"),this.field_debug(),t.addAction("wponion_after_fields_reload")},t.addAction("wponion_before_init",function(){wponion_field(".wponion-framework").reload()})}(window,document,jQuery,$wponion,$wponion_field);