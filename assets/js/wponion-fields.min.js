"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e,n,s,c,i,o){var t=wp.hooks;i.fn.inputmask=function(){if(0<this.elem.length){var e=this.arg("inputmask");e&&(this.save(this.elem.inputmask(e)),c.__plugin_debug_info(this.elem,"inputmask",e))}return this},i.fn.maxlength=function(){if(0<this.elem.length){var e=this.arg("max_length");e&&(e.appendToParent=!0,void 0!==e.threshold&&(e.threshold=parseInt(e.threshold)),void 0===e.warningClass&&(e.warningClass="badge badge-success"),void 0===e.limitReachedClass&&(e.limitReachedClass="badge badge-danger"),this.save(this.elem.maxlength(e)),c.__plugin_debug_info(this.elem,"max_length",e))}return this},i.fn.field_debug=function(){0<this.elem.find(".wponion-field-debug").length&&this.elem.find(".wponion-field-debug a.wponion-field-debug-handle").on("click",function(){var n=c._get_debug_info(s(this),{}),e=c.field_js_id(s(this))+"debugINFO",i="<p class='wponion-field-debug-notice'>"+c.settings("debug_notice")+"</p>",o=s("<div id='"+e+"' class='wponion-field-debug-popup' ><div id='"+e+"' ></div> "+i+"</div>");swal({html:o,showConfirmButton:!0,confirmButtonText:c.txt("get_json_output","Get JSON Output"),showCloseButton:!1,width:"800px",onOpen:function(){s("#swal2-content > div > #"+e).jsonView(n).overlayScrollbars({className:"os-theme-dark",resize:"vertical"})}}).then(function(e){e.value&&swal({width:"600px",html:'<textarea style="min-width:550px; min-height:300px">'+JSON.stringify(n)+"</textarea>"})})});return this},i.fn.icon_picker=function(){var e=this,n=e.elem,i=e.args(),o=n.find(".wponion-icon-picker-input"),t=n.find("button.wponion-remove-icon"),a=n.find("button.wponion-add-icon"),l=n.find("span.wponion-icon-preview"),r={elems:null,popup:null,popupel:null,init_tooltip:function(){if("false"!==i.popup_tooltip){var e="object"===_typeof(i.popup_tooltip)?i.popup_tooltip:{};0<r.elems.length&&r.elems.each(function(){tippy(s(this)[0],e)})}},init:function(e,n){r.popupel=e,r.popup=n,r.elems=r.popupel.find("span.wponion-icon-preview");var i=r.popupel.find(".wponion-icon-picker-container-scroll").css("height");r.popupel.find(".wponion-icon-picker-container-scroll").css("height",i),r.select(),r.input(),r.elems.on("click",function(){var e=s(this).attr("data-icon");o.val(e).trigger("change"),swal.closeModal()}),r.init_tooltip()},input:function(){r.popupel.find("div.wponion-icon-picker-model-header input[type=text]").on("keyup",function(){var e=s(this).val();r.elems.each(function(){s(this).attr("data-icon").search(new RegExp(e,"i"))<0?s(this).parent().hide():s(this).parent().show()})})},select:function(){r.popupel.find("div.wponion-icon-picker-model-header select").on("change",function(){swal.enableLoading();var e=s(this).val();c.ajax("icon_picker",{data:{"wponion-icon-lib":e}},function(e){e.success?(swal.resetValidationError(),s(r.popupel).find("#swal2-content").html(e.data).show(),s(r.popupel).find("#swal2-content .wponion-icon-picker-container-scroll").overlayScrollbars({className:"os-theme-dark",resize:"vertical"}),r.init(r.popupel,r.popup)):(s(r.popupel).find(".wponion-icon-picker-container-scroll").remove(),r.popup.showValidationError(e.data))},function(){r.popup.showValidationError(c.txt("unknown_ajax_error"))},function(){r.popup.disableLoading()})})}};return""===o.val()&&(t.hide(),l.hide()),o.on("keyup blur change keypress",function(){var e=s(this).val();""!==e?(l.html('<i class="'+e+'"></i>').show(),t.show()):(l.hide(),t.hide())}),a.on("click",function(){var o=swal({title:n.find(".wponion-field-title h4").html(),animation:!1,allowOutsideClick:!1,showConfirmButton:!1,showCloseButton:!0,width:"700px",customClass:"wponion-icon-picker-model",onBeforeOpen:function(i){swal.enableLoading(),e.ajax("icon_picker",{onSuccess:function(e){if(e.success){swal.resetValidationError();var n=s(i);n.find("#swal2-content").html(e.data).show(),n.find("#swal2-content .wponion-icon-picker-container-scroll").overlayScrollbars({className:"os-theme-dark",resize:"vertical"}),r.init(n,o)}else c.tost({type:"error",title:e.data}),o.showValidationError(e.data)},onError:function(){o.showValidationError(c.txt("unknown_ajax_error"))},onAlways:function(){o.disableLoading()}})}})}),t.on("click",function(){o.val(""),l.hide(),t.hide()}),this},i.fn.select2=function(){var e=this.arg("select2",{});return e=c.validate_js_function(e),this.save(this.elem.select2(e)),this},i.fn.chosen=function(){var e=this.arg("chosen");return this.save(this.elem.chosen(e)),this},i.fn.selectize=function(){var e=this.arg("selectize");return void 0!==e.theme&&this.elem.parent().addClass(e.theme),this.save(this.elem.selectize(e)),this},i.fn.clone_element=function(){var e=this,n=e.elem,i=n.find("div.wponion-clone-wrap"),o=n.find(".wponion-clone-add"),t=(i.find(".wponion-clone-remove"),e.arg("clone")),a=void 0!==t.limit&&t.limit,l=void 0===t.toast_error||t.toast_error,r=t.error_msg;i.WPOnionCloner({add_btn:o,limit:a,clone_elem:".wponion-field-clone",remove_btn:".wponion-clone-remove",template:e.arg("clone_template"),onRemove:function(e){e.parent().parent().remove()},templateAfterRender:function(e){var n=e.find("> div.wponion-field-clone:last-child");wponion_field(n).reload()},sortable:{items:".wponion-field-clone",handle:".wponion-field-clone-sorter",placeholder:".wponion-cloner-placeholder",start:function(e,n){n.item.css("background-color","#eeee")},stop:function(e,n){n.item.removeAttr("style")}},onLimitReached:function(){if(!0===l)c.tost({type:"error",title:r});else{var e=s('<div class="alert alert-warning" role="alert">'+r+"</div>").hide();o.parent().prepend(e),o.parent().find("div.alert").fadeIn(function(){var e=s(this);setTimeout(function(){e.fadeOut("slow",function(){e.remove()})},1e3)})}}})},i.fn.field_tooltip=function(){var e=this.elem.attr("data-field-jsid"),o={};if(this.arg(e)){var n=this.arg(e+"tooltip");!1!==n.image&&(0===s("#wponiontooltipimagetippy").length&&s("body").append(s('<div id="wponiontooltipimagetippy" style="display: none;">Loading.</div>')),n.html="#wponiontooltipimagetippy",n.onShow=function(){var i=this.querySelector(".tippy-content");o.loading||(o.loading=!0,fetch(n.image).then(function(e){return e.blob()}).then(function(e){var n=URL.createObjectURL(e);i.innerHTML='<img width="200" height="200" src="'+n+'">',o.loading=!1}).catch(function(e){i.innerHTML="Loading failed",o.loading=!1}))},n.onHidden=function(){this.querySelector(".tippy-content").innerHTML=""},n.popperOptions={modifiers:{preventOverflow:{enabled:!1},hide:{enabled:!1}}}),o=tippy(this.elem[0],n),this.save(o)}return this},i.fn.font_selector=function(){var e=this.elem,n=e.find("select.wponion-font-selector"),i=e.find("select.wponion-variant-selector"),o=c.js_args("wponion_websafe_fonts"),t=c.js_args("wponion_gfonts"),a=function(e){var n="";for(var i in e)n+='<option value="'+i+'">'+e[i]+"</option>";return n};return n.on("change",function(){var e=s(this).val(),n=null;void 0!==o.fonts[e]?n=a(o.variants):void 0!==t[e]&&(n=a(t[e])),i.html(n),c.trigger_update_select(i)}),this},i.fn.accordion=function(){this.elem.each(function(){s(this).find(".wponion-accordion-wrap").each(function(){s(this).accordion({header:"> .wponion-accordion-title",collapsible:!0,animate:250,heightStyle:"content",active:s(this).hasClass("is_open"),icons:{header:"dashicons dashicons-arrow-right",activeHeader:"dashicons dashicons-arrow-down"}})})})},i.fn.group=function(){var e=this.elem,n=e.find("> .wponion-fieldset > .wponion-add-group"),i=e.find("> .wponion-fieldset > .wponion-group-wrap"),o=this.arg("limit"),t=this.arg("error_msg");wponion_field(e).accordion(),i.WPOnionCloner({add_btn:n,limit:parseInt(o),clone_elem:"> .wponion-fieldset > .wponion-accordion-wrap",remove_btn:".wponion-group-remove",template:this.arg("group_template"),onRemove:function(e){e.parent().parent().parent().remove()},templateAfterRender:function(e){var n=i.find("> .wponion-accordion-wrap:last-child");wponion_field(i).accordion(),wponion_field(n).reload()},sortable:{items:".wponion-accordion-wrap",handle:".wponion-accordion-title",placeholder:".wponion-accordion-placeholder",start:function(e,n){n.item.css("background-color","#eeee")},stop:function(e,n){n.item.removeAttr("style")}},onLimitReached:function(){var e=s('<div class="alert alert-warning" role="alert">'+t+"</div>").hide();n.before(e),n.parent().find("div.alert").fadeIn(function(){var e=s(this);setTimeout(function(){e.fadeOut("slow",function(){e.remove()})},1e3)})}})},i.fn.dependency=function(e,n){if(0<e.find(".wponion-has-dependency").length){var i={init:function(){i.ruleset=s.deps.createRuleset();void 0!==n?i.dep_sub():i.dep_root(),s.deps.enable(e,i.ruleset,{show:function(e){e.show()},hide:function(e){e.hide()},log:!1,checkTargets:!1})},dep_root:function(){e.find(".wponion-has-dependency").each(function(){var t=s(this),e=c.field_args(t,{}),a=i.ruleset;if(void 0!==e.dependency){var n=e.dependency.controller,l=e.dependency.condition,r=e.dependency.value;s.each(n,function(e,n){var i=r[e]||"",o=l[e]||l[0];a.createRule('[data-depend-id="'+n+'"]',o,i).include(t)})}})}};i.init()}},i.fn.__dependency=function(){var r=s(".wponion-framework"),n=this,i=this.arg("dependency");n.init=function(){n.ruleset=s.deps.createRuleset();n.dep_root(),s.deps.enable(r,n.ruleset,{log:!0,checkTargets:!1})},n.dep_root=function(){var e=i.controller,t=i.condition,a=i.value,l=n.ruleset;s.each(e,function(e,n){var i=a[e]||"",o=t[e]||t[0];l.createRule('[data-depend-id="'+n+'"]',o,i).include(r)})},n.init()},i.fn.reload=function(){t.addAction("wponion_before_fields_reload"),this.init_field("input[data-wponion-inputmask]","inputmask"),this.init_field("[data-wponion-maxlength]","maxlength"),this.init_field(".wponion-element-icon_picker","icon_picker"),this.init_field(".select2","select2"),this.init_field(".chosen","chosen"),this.init_field(".selectize","selectize"),this.init_field(".wponion-element-accordion","accordion"),this.init_field(".wponion-element-group","group"),this.init_field(".wponion-element-clone","clone_element"),this.init_field(".wponion-field-tooltip","field_tooltip"),this.init_field(".wponion-element-font","font_selector"),this.field_debug(),t.addAction("wponion_after_fields_reload")},t.addAction("wponion_before_init",function(){wponion_field(".wponion-framework").reload(),i.fn.dependency(s(".wponion-framework"))})}(window,document,jQuery,$wponion,$wponion_field);