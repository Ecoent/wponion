"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};!function(n,i,f,h,e,t){var o=wp.hooks;e.fn.inputmask=function(){if(0<this.elem.length){var n=this.arg("inputmask");n&&(this.save(this.elem.inputmask(n)),h.__plugin_debug_info(this.elem,"inputmask",n))}return this},e.fn.maxlength=function(){if(0<this.elem.length){var n=this.arg("max_length");n&&(n.appendToParent=!0,void 0!==n.threshold&&(n.threshold=parseInt(n.threshold)),void 0===n.warningClass&&(n.warningClass="badge badge-success"),void 0===n.limitReachedClass&&(n.limitReachedClass="badge badge-danger"),this.save(this.elem.maxlength(n)),h.__plugin_debug_info(this.elem,"max_length",n))}return this},e.fn.field_debug=function(){0<this.elem.find(".wponion-field-debug").length&&this.elem.find(".wponion-field-debug a.wponion-field-debug-handle").on("click",function(){var i=h._get_debug_info(f(this),{}),n=h.field_js_id(f(this))+"debugINFO",e="<p class='wponion-field-debug-notice'>"+h.settings("debug_notice")+"</p>",t=f("<div id='"+n+"' class='wponion-field-debug-popup' ><div id='"+n+"' ></div> "+e+"</div>");swal({html:t,showConfirmButton:!0,confirmButtonText:h.txt("get_json_output","Get JSON Output"),showCloseButton:!1,width:"800px",onOpen:function(){f("#swal2-content > div > #"+n).jsonView(i).overlayScrollbars({className:"os-theme-dark",resize:"vertical"})}}).then(function(n){n.value&&swal({width:"600px",html:'<textarea style="min-width:550px; min-height:300px">'+JSON.stringify(i)+"</textarea>"})})});return this},e.fn.icon_picker=function(){var n=this,i=n.elem,e=n.args(),t=i.find(".wponion-icon-picker-input"),o=i.find("button.wponion-remove-icon"),a=i.find("button.wponion-add-icon"),l=i.find("span.wponion-icon-preview"),s={elems:null,popup:null,popupel:null,init_tooltip:function(){if("false"!==e.popup_tooltip){var n="object"===_typeof(e.popup_tooltip)?e.popup_tooltip:{};0<s.elems.length&&s.elems.each(function(){tippy(f(this)[0],n)})}},init:function(n,i){s.popupel=n,s.popup=i,s.elems=s.popupel.find("span.wponion-icon-preview");var e=s.popupel.find(".wponion-icon-picker-container-scroll").css("height");s.popupel.find(".wponion-icon-picker-container-scroll").css("height",e),s.select(),s.input(),s.elems.on("click",function(){var n=f(this).attr("data-icon");t.val(n).trigger("change"),swal.closeModal()}),s.init_tooltip()},input:function(){s.popupel.find("div.wponion-icon-picker-model-header input[type=text]").on("keyup",function(){var n=f(this).val();s.elems.each(function(){f(this).attr("data-icon").search(new RegExp(n,"i"))<0?f(this).parent().hide():f(this).parent().show()})})},select:function(){s.popupel.find("div.wponion-icon-picker-model-header select").on("change",function(){swal.enableLoading();var n=f(this).val();h.ajax("icon_picker",{data:{"wponion-icon-lib":n}},function(n){n.success?(swal.resetValidationError(),f(s.popupel).find("#swal2-content").html(n.data).show(),f(s.popupel).find("#swal2-content .wponion-icon-picker-container-scroll").overlayScrollbars({className:"os-theme-dark",resize:"vertical"}),s.init(s.popupel,s.popup)):(f(s.popupel).find(".wponion-icon-picker-container-scroll").remove(),s.popup.showValidationError(n.data))},function(){s.popup.showValidationError(h.txt("unknown_ajax_error"))},function(){s.popup.disableLoading()})})}};return""===t.val()&&(o.hide(),l.hide()),t.on("keyup blur change keypress",function(){var n=f(this).val();""!==n?(l.html('<i class="'+n+'"></i>').show(),o.show()):(l.hide(),o.hide())}),a.on("click",function(){var t=swal({title:i.find(".wponion-field-title h4").html(),animation:!1,allowOutsideClick:!1,showConfirmButton:!1,showCloseButton:!0,width:"700px",customClass:"wponion-icon-picker-model",onBeforeOpen:function(e){swal.enableLoading(),n.ajax("icon_picker",{onSuccess:function(n){if(n.success){swal.resetValidationError();var i=f(e);i.find("#swal2-content").html(n.data).show(),i.find("#swal2-content .wponion-icon-picker-container-scroll").overlayScrollbars({className:"os-theme-dark",resize:"vertical"}),s.init(i,t)}else h.tost({type:"error",title:n.data}),t.showValidationError(n.data)},onError:function(){t.showValidationError(h.txt("unknown_ajax_error"))},onAlways:function(){t.disableLoading()}})}})}),o.on("click",function(){t.val(""),l.hide(),o.hide()}),this},e.fn.select2=function(){var n=this.arg("select2",{});return this.save(this.elem.select2(n)),this},e.fn.chosen=function(){var n=this.arg("chosen");return this.save(this.elem.chosen(n)),this},e.fn.selectize=function(){var n=this.arg("selectize");return void 0!==n.theme&&this.elem.parent().addClass(n.theme),this.save(this.elem.selectize(n)),this},e.fn.clone_element=function(){var a=this,l=a.elem.find("div.wponion-clone-wrap"),s=l.find(".wponion-clone-add"),n=l.find(".wponion-clone-remove"),i=a.arg("clone"),r=void 0!==i.limit&&i.limit,p=void 0===i.toast_error||i.toast_error,c=i.error_msg,d=function(){if(!f(this).hasClass("removing")){f(this).addClass("removing").parent().parent().remove();var n=parseInt(l.attr("data-wponion-clone-count"))-1;l.attr("data-wponion-clone-count",n)}};return s.on("click",function(){var n=a.arg("clone_template"),i=parseInt(l.attr("data-wponion-clone-count"));if(!1===r||r!==i){var e=i+1;if(n){n=n.replace(/{cloneid}/g,e),l.attr("data-wponion-clone-count",e),f(this).parent().parent().find("div.wponion-clone-actions").before(f(n));var t=f(this).parent().parent().before();t.find(".wponion-clone-remove").on("click",d),wponion_field(t).reload()}}else if(!0===p)h.tost({type:"error",title:c});else{var o=f('<div class="alert alert-warning" role="alert">'+c+"</div>");o.hide(),s.parent().prepend(o),(o=s.parent().find("div.alert")).fadeIn(function(){setTimeout(function(){o.fadeOut("slow",function(){o.remove()})},1e3)})}}),n.on("click",d),this},e.fn.field_tooltip=function(){var n=this.elem.attr("data-field-jsid"),t={};if(this.arg(n)){var i=this.arg(n+"tooltip");!1!==i.image&&(0===f("#wponiontooltipimagetippy").length&&f("body").append(f('<div id="wponiontooltipimagetippy" style="display: none;">Loading.</div>')),i.html="#wponiontooltipimagetippy",i.onShow=function(){var e=this.querySelector(".tippy-content");t.loading||(t.loading=!0,fetch(i.image).then(function(n){return n.blob()}).then(function(n){var i=URL.createObjectURL(n);e.innerHTML='<img width="200" height="200" src="'+i+'">',t.loading=!1}).catch(function(n){e.innerHTML="Loading failed",t.loading=!1}))},i.onHidden=function(){this.querySelector(".tippy-content").innerHTML=""},i.popperOptions={modifiers:{preventOverflow:{enabled:!1},hide:{enabled:!1}}}),t=tippy(this.elem[0],i),this.save(t)}return this},e.fn.font_selector=function(){var n=this.elem,i=n.find("select.wponion-font-selector"),e=n.find("select.wponion-variant-selector"),t=h.js_args("wponion_websafe_fonts"),o=h.js_args("wponion_gfonts"),a=function(n){var i="";for(var e in n)i+='<option value="'+e+'">'+n[e]+"</option>";return i};return i.on("change",function(){var n=f(this).val(),i=null;void 0!==t.fonts[n]?i=a(t.variants):void 0!==o[n]&&(i=a(o[n])),e.html(i),h.trigger_update_select(e)}),this},e.fn.reload=function(){o.addAction("wponion_before_fields_reload"),this.init_field("input[data-wponion-inputmask]","inputmask"),this.init_field("[data-wponion-maxlength]","maxlength"),this.init_field(".wponion-element-icon_picker","icon_picker"),this.init_field(".select2","select2"),this.init_field(".chosen","chosen"),this.init_field(".selectize","selectize"),this.init_field(".wponion-element-clone","clone_element"),this.init_field(".wponion-field-tooltip","field_tooltip"),this.init_field(".wponion-element-font","font_selector"),this.field_debug(),o.addAction("wponion_after_fields_reload")},o.addAction("wponion_before_init",function(){wponion_field(".wponion-framework").reload()})}(window,document,jQuery,$wponion,$wponion_field);